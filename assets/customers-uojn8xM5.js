import{j as g,r as p,N as a,O as f,a3 as s,Q as i,Y as h,Z as y,$ as w,H as C,S as c,U as l,V as d,W as x}from"./index-CjvAX0Hz.js";import{g as n}from"./generateUniqueId-BGfF6MB9.js";import{g as D}from"./getDocumentsByFilters-BwA6FY7u.js";const q=g("customers",()=>{const m=p(null);return{createCustomer:async r=>{const e=r;e.photo&&e.photo instanceof File&&await a(e.photo,`user_photos/${n()}`).then(t=>{e.photo=t}),e.experience=await Promise.all(e.experience.map(async t=>(t.logo&&t.logo instanceof File&&(t.logo=await a(t.logo,`experience_logos/${n()}`)),t)));try{const t=await f(s,e);return await i(t,{id:t.id}),{status:1}}catch(t){return console.log(t),{status:0}}},getCustomersByFilters:async(r=1,e)=>{try{const{documents:t,totalPages:o}=await D(s,m,r,e);return console.log(t),{documents:t,totalPages:o}}catch(t){return console.error("Error fetching documents: ",t),{documents:[],totalPages:0}}},deleteDocument:async r=>{try{const e=c(s,r),t=await l(e);if(t.exists()){const o=t.data();o.photo&&await d(o.photo);for(const u of o.experience)u.logo&&await d(u.logo)}return await x(e),{status:1}}catch(e){return console.error("Error deleting document: ",e),{status:0}}},getCustomerById:async r=>{try{const e=c(s,r),t=await l(e);return t.exists()?{status:1,document:{...t.data()}}:{status:0,document:null}}catch(e){return console.error("Error fetching document: ",e),{status:0,document:null}}},updateCustomer:async(r,e)=>{const t=r;t.photo&&t.photo instanceof File&&await a(t.photo,`user_photos/${n()}`).then(o=>{t.photo=o}),t.experience=await Promise.all(t.experience.map(async o=>(o.logo&&o.logo instanceof File&&(o.logo=await a(o.logo,`experience_logos/${n()}`)),o)));try{const o=c(s,e);return await i(o,{...r}),{status:1}}catch(o){return console.log("Error updating document:",o),{status:0}}},getAllDocuments:()=>{const r=h(s,y("createdAt")),e=w(r);return{documents:C(()=>e.value.map(o=>({id:o.id,...o})))}}}});export{q as u};
